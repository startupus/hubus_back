# –ü—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ OpenAI API

## üìã –û–±–∑–æ—Ä

–î–ª—è —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è OpenRouter (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ), –º—ã –¥–æ–±–∞–≤–∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π endpoint –¥–ª—è –ø—Ä—è–º–æ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ OpenAI API.

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä—è–º–æ–π OpenAI endpoint (`/api/v1/openai/chat/completions`) –∫–æ–≥–¥–∞:
- ‚úÖ –ù—É–∂–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ **–≤–∏–¥–µ–æ** (OpenRouter –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ)
- ‚úÖ –ù—É–∂–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏, –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ –ø—Ä—è–º–æ–º OpenAI API
- ‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å OpenAI API

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π endpoint (`/api/v1/chat/completions`) –∫–æ–≥–¥–∞:
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç–µ —Å —Ç–µ–∫—Å—Ç–æ–º, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –∞—É–¥–∏–æ (—á–µ—Ä–µ–∑ OpenRouter)
- ‚úÖ –ù—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –º–Ω–æ–∂–µ—Å—Ç–≤—É –º–æ–¥–µ–ª–µ–π —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
- ‚úÖ –•–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã OpenAI

## üîë Endpoint

### POST `/api/v1/openai/chat/completions`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:** `Authorization: Bearer ak_[YOUR_API_KEY]`

**Content-Type:** `application/json`

## üìù –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å (—Ç–µ–∫—Å—Ç)

```json
{
  "model": "gpt-4o",
  "messages": [
    {
      "role": "user",
      "content": "–ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?"
    }
  ],
  "max_tokens": 500
}
```

### –ó–∞–ø—Ä–æ—Å —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º (Vision API)

```json
{
  "model": "gpt-4o",
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "–û–ø–∏—à–∏ —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ"
        },
        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/jpeg;base64,/9j/4AAQSkZJRg..."
          }
        }
      ]
    }
  ],
  "max_tokens": 500
}
```

### –ó–∞–ø—Ä–æ—Å —Å –≤–∏–¥–µ–æ ‚≠ê –ù–û–í–û–ï

```json
{
  "model": "gpt-4o",
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "–û–ø–∏—à–∏, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —ç—Ç–æ–º –≤–∏–¥–µ–æ. –ö–∞–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è?"
        },
        {
          "type": "video",
          "video": {
            "url": "data:video/mp4;base64,AAAAIGZ0eXBpc29t..."
          }
        }
      ]
    }
  ],
  "max_tokens": 1000
}
```

**–í–∞–∂–Ω–æ:** 
- –í–∏–¥–µ–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ base64 data URL
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã: MP4, MOV, AVI
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏ (–æ–±—ã—á–Ω–æ –¥–æ 20MB)
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–µ –≤–∏–¥–µ–æ (–¥–æ 1 –º–∏–Ω—É—Ç—ã)

### –ó–∞–ø—Ä–æ—Å —Å –ø—É–±–ª–∏—á–Ω—ã–º URL –≤–∏–¥–µ–æ

```json
{
  "model": "gpt-4o",
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "–û–ø–∏—à–∏ —ç—Ç–æ –≤–∏–¥–µ–æ"
        },
        {
          "type": "video",
          "video": {
            "url": "https://example.com/video.mp4"
          }
        }
      ]
    }
  ],
  "max_tokens": 1000
}
```

## üì§ –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

–û—Ç–≤–µ—Ç –∏–¥–µ–Ω—Ç–∏—á–µ–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É OpenAI API:

```json
{
  "id": "chatcmpl-123",
  "object": "chat.completion",
  "created": 1677652288,
  "model": "gpt-4o",
  "choices": [
    {
      "index": 0,
      "message": {
        "role": "assistant",
        "content": "–í —ç—Ç–æ–º –≤–∏–¥–µ–æ –ø–æ–∫–∞–∑–∞–Ω–æ..."
      },
      "finish_reason": "stop"
    }
  ],
  "usage": {
    "prompt_tokens": 100,
    "completion_tokens": 50,
    "total_tokens": 150
  },
  "provider": "openai",
  "processing_time_ms": 1234
}
```

## üîß –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----|--------------|-----------|
| `model` | string | ‚úÖ –î–∞ | –ú–æ–¥–µ–ª—å OpenAI (–Ω–∞–ø—Ä–∏–º–µ—Ä, `gpt-4o`, `gpt-4-turbo`) |
| `messages` | array | ‚úÖ –î–∞ | –ú–∞—Å—Å–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π |
| `max_tokens` | number | ‚ùå –ù–µ—Ç | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ |
| `temperature` | number | ‚ùå –ù–µ—Ç | –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (0-2), –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 1 |
| `top_p` | number | ‚ùå –ù–µ—Ç | Top-p sampling (0-1) |
| `stream` | boolean | ‚ùå –ù–µ—Ç | Stream –æ—Ç–≤–µ—Ç (–ø–æ–∫–∞ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è) |

## üìã –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –º–æ–¥–µ–ª–∏

- `gpt-4o` - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –≤–∏–¥–µ–æ –∏ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á
- `gpt-4-turbo` - –î–ª—è —Ç–µ–∫—Å—Ç–∞ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `gpt-4` - –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –º–æ–¥–µ–ª—å
- `gpt-3.5-turbo` - –ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä–∞—è –∏ –¥–µ—à–µ–≤–∞—è –º–æ–¥–µ–ª—å

**–í–∞–∂–Ω–æ:** –ú–æ–¥–µ–ª–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è **–±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–∞** `openai/` (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç OpenRouter endpoint).

## üíª –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### cURL

```bash
curl -X POST "http://localhost:3000/api/v1/openai/chat/completions" \
  -H "Authorization: Bearer ak_YOUR_API_KEY" \
  -H "Content-Type: application/json" \
  -d '{
    "model": "gpt-4o",
    "messages": [
      {
        "role": "user",
        "content": [
          {
            "type": "text",
            "text": "–û–ø–∏—à–∏ —ç—Ç–æ –≤–∏–¥–µ–æ"
          },
          {
            "type": "video",
            "video": {
              "url": "data:video/mp4;base64,AAAAIGZ0eXBpc29t..."
            }
          }
        ]
      }
    ],
    "max_tokens": 1000
  }'
```

### PowerShell

```powershell
$headers = @{
    "Authorization" = "Bearer ak_YOUR_API_KEY"
    "Content-Type" = "application/json"
}

$body = @{
    model = "gpt-4o"
    messages = @(
        @{
            role = "user"
            content = @(
                @{
                    type = "text"
                    text = "–û–ø–∏—à–∏ —ç—Ç–æ –≤–∏–¥–µ–æ"
                },
                @{
                    type = "video"
                    video = @{
                        url = "data:video/mp4;base64,AAAAIGZ0eXBpc29t..."
                    }
                }
            )
        }
    )
    max_tokens = 1000
} | ConvertTo-Json -Depth 10

$response = Invoke-RestMethod -Uri "http://localhost:3000/api/v1/openai/chat/completions" `
    -Method POST -Headers $headers -Body $body

Write-Output $response.choices[0].message.content
```

### Python

```python
import requests
import base64

# –ß–∏—Ç–∞–µ–º –≤–∏–¥–µ–æ —Ñ–∞–π–ª –∏ –∫–æ–¥–∏—Ä—É–µ–º –≤ base64
with open("video.mp4", "rb") as video_file:
    video_base64 = base64.b64encode(video_file.read()).decode('utf-8')
    video_data_url = f"data:video/mp4;base64,{video_base64}"

headers = {
    "Authorization": "Bearer ak_YOUR_API_KEY",
    "Content-Type": "application/json"
}

data = {
    "model": "gpt-4o",
    "messages": [
        {
            "role": "user",
            "content": [
                {
                    "type": "text",
                    "text": "–û–ø–∏—à–∏, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —ç—Ç–æ–º –≤–∏–¥–µ–æ"
                },
                {
                    "type": "video",
                    "video": {
                        "url": video_data_url
                    }
                }
            ]
        }
    ],
    "max_tokens": 1000
}

response = requests.post(
    "http://localhost:3000/api/v1/openai/chat/completions",
    headers=headers,
    json=data
)

print(response.json()["choices"][0]["message"]["content"])
```

## ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–¢—Ä–µ–±—É–µ—Ç—Å—è OpenAI API –∫–ª—é—á**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `OPENAI_API_KEY` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ `proxy-service`
2. **–†–∞–∑–º–µ—Ä –≤–∏–¥–µ–æ**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ –º–æ–¥–µ–ª–∏ (–æ–±—ã—á–Ω–æ –¥–æ 20MB)
3. **–¢–∞–π–º–∞—É—Ç**: 2 –º–∏–Ω—É—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤–∏–¥–µ–æ
4. **–°—Ç–æ–∏–º–æ—Å—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–∞—Ä–∏—Ñ—ã OpenAI –Ω–∞–ø—Ä—è–º—É—é (–æ–±—ã—á–Ω–æ –≤—ã—à–µ, —á–µ–º —á–µ—Ä–µ–∑ OpenRouter)

## üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å OpenRouter endpoint

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | `/api/v1/chat/completions` (OpenRouter) | `/api/v1/openai/chat/completions` (OpenAI) |
|----------------|-----------------------------------------|---------------------------------------------|
| –í–∏–¥–µ–æ | ‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è |
| –ê—É–¥–∏–æ | ‚úÖ –ß–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ | ‚úÖ –ß–µ—Ä–µ–∑ GPT-4o |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è | ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è |
| –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–µ–π | ‚úÖ –î–∞ (OpenRouter) | ‚ùå –¢–æ–ª—å–∫–æ OpenAI |
| –°—Ç–æ–∏–º–æ—Å—Ç—å | üí∞ –û–±—ã—á–Ω–æ –Ω–∏–∂–µ | üí∞üíµ –ü—Ä—è–º—ã–µ —Ç–∞—Ä–∏—Ñ—ã OpenAI |
| –°–∫–æ—Ä–æ—Å—Ç—å | ‚ö° –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ | ‚ö° –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ OpenAI |

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–î–ª—è –≤–∏–¥–µ–æ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/api/v1/openai/chat/completions` —Å –º–æ–¥–µ–ª—å—é `gpt-4o`
- **–î–ª—è —Ç–µ–∫—Å—Ç–∞/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/api/v1/chat/completions` —á–µ—Ä–µ–∑ OpenRouter (–¥–µ—à–µ–≤–ª–µ)
- **–î–ª—è –∞—É–¥–∏–æ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/v1/audio/transcriptions` –¥–ª—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–±–∞—Ü–∏–∏ –∏–ª–∏ `/api/v1/openai/chat/completions` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

## üêõ –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫—É "OpenAI API key is not configured":
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ `OPENAI_API_KEY` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ `.env` —Ñ–∞–π–ª–µ
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ `proxy-service` –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker logs project-proxy-service-1`

–ï—Å–ª–∏ –≤–∏–¥–µ–æ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –º–æ–¥–µ–ª—å `gpt-4o`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –≤–∏–¥–µ–æ (MP4, MOV, AVI)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∏–¥–µ–æ –≤ base64 –∏–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –ø—É–±–ª–∏—á–Ω–æ–º—É URL
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ 20MB)



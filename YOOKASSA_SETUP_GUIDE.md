# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ÆKassa –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –ø–ª–∞—Ç–µ–∂–µ–π

## üîê –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ÆKassa

### 1. YOOKASSA_SHOP_ID
**–ß—Ç–æ —ç—Ç–æ:** –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–∞–≥–∞–∑–∏–Ω–∞ –≤ —Å–∏—Å—Ç–µ–º–µ –ÆKassa

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å:**
1. –ó–∞–π–¥–∏—Ç–µ –≤ [–ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –ÆKassa](https://yookassa.ru/my)
2. –í–æ–π–¥–∏—Ç–µ –≤ —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç –∏–ª–∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å
3. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "API"
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Shop ID** (–æ–±—ã—á–Ω–æ —ç—Ç–æ —á–∏—Å–ª–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä: `123456`)

**–ü—Ä–∏–º–µ—Ä:** `YOOKASSA_SHOP_ID="123456"`

### 2. YOOKASSA_SECRET_KEY
**–ß—Ç–æ —ç—Ç–æ:** –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –ÆKassa

**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å:**
1. –í —Ç–æ–º –∂–µ —Ä–∞–∑–¥–µ–ª–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "API"
2. –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á" –∏–ª–∏ "–ü–æ–∫–∞–∑–∞—Ç—å –∫–ª—é—á"
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Secret Key** (–¥–ª–∏–Ω–Ω–∞—è —Å—Ç—Ä–æ–∫–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä: `test_1234567890abcdef...`)

**–ü—Ä–∏–º–µ—Ä:** `YOOKASSA_SECRET_KEY="test_1234567890abcdef1234567890abcdef"`

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –ÆKassa
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ [yookassa.ru](https://yookassa.ru)
2. –ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è"
3. –í—ã–±–µ—Ä–∏—Ç–µ "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω"
4. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ –º–∞–≥–∞–∑–∏–Ω–∞:** AI Aggregator
   - **–°–∞–π—Ç:** –≤–∞—à –¥–æ–º–µ–Ω (–¥–ª—è —Ç–µ—Å—Ç–æ–≤ –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å localhost)
   - **–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–æ–≤:** IT-—É—Å–ª—É–≥–∏ / –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ
   - **–û–∂–∏–¥–∞–µ–º—ã–π –æ–±–æ—Ä–æ—Ç:** —É–∫–∞–∂–∏—Ç–µ –ø—Ä–∏–º–µ—Ä–Ω—É—é —Å—É–º–º—É

### –®–∞–≥ 2: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
1. **–î–æ–∫—É–º–µ–Ω—Ç—ã:** –∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø–∞—Å–ø–æ—Ä—Ç –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω–∞ –ò–ü/–û–û–û
2. **–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã:** —É–∫–∞–∂–∏—Ç–µ —Ä–∞—Å—á–µ—Ç–Ω—ã–π —Å—á–µ—Ç
3. **–û–∂–∏–¥–∞–Ω–∏–µ:** –æ–±—ã—á–Ω–æ 1-3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è

### –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π API
1. –ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è –∑–∞—è–≤–∫–∏ –∑–∞–π–¥–∏—Ç–µ –≤ –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "API"
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Shop ID** –∏ **Secret Key**

### –®–∞–≥ 4: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook'–æ–≤
1. –í —Ä–∞–∑–¥–µ–ª–µ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" ‚Üí "Webhook"
2. –£–∫–∞–∂–∏—Ç–µ URL: `https://yourdomain.com/v1/webhook/yookassa`
3. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–±—ã—Ç–∏—è: `payment.succeeded`, `payment.canceled`

## üß™ –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º

### –¢–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏
–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–ª—é—á–∏:
```env
YOOKASSA_SHOP_ID="test_shop_id"
YOOKASSA_SECRET_KEY="test_secret_key"
```

### –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã
–ÆKassa –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- **–£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞:** `5555 5555 5555 4444`
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤:** `5555 5555 5555 4445`
- **–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω–∞—è –∫–∞—Ä—Ç–∞:** `5555 5555 5555 4446`

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:
1. **–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ** `.env` —Ñ–∞–π–ª –≤ Git
2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏** –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø** –∫ —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–∞–º
4. **–†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç–∏—Ä—É–π—Ç–µ** –∫–ª—é—á–∏ (—Ä–∞–∑ –≤ 3-6 –º–µ—Å—è—Ü–µ–≤)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Docker:
```yaml
environment:
  - YOOKASSA_SHOP_ID=${YOOKASSA_SHOP_ID}
  - YOOKASSA_SECRET_KEY=${YOOKASSA_SECRET_KEY}
```

## üí∞ –ö–æ–º–∏—Å—Å–∏–∏ –ÆKassa

### –°–ë–ü (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π):
- **–ö–æ–º–∏—Å—Å–∏—è:** 0.5% –æ—Ç —Å—É–º–º—ã –ø–ª–∞—Ç–µ–∂–∞
- **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞:** 1 —Ä—É–±–ª—å
- **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—É–º–º–∞:** 600,000 —Ä—É–±–ª–µ–π –∑–∞ –æ–¥–∏–Ω –ø–ª–∞—Ç–µ–∂

### –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:
- **–°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞:** 1000 —Ä—É–±–ª–µ–π
- **–ö–æ–º–∏—Å—Å–∏—è –ÆKassa:** 5 —Ä—É–±–ª–µ–π (0.5%)
- **–ö –∑–∞—á–∏—Å–ª–µ–Ω–∏—é:** 995 —Ä—É–±–ª–µ–π

## üöÄ –ì–æ—Ç–æ–≤—ã–π .env —Ñ–∞–π–ª

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `services/payment-service/.env`:

```env
# Database
PAYMENT_DATABASE_URL="postgresql://postgres:password@payment-db:5432/payment_db?schema=public"

# YooKassa Configuration
YOOKASSA_SHOP_ID="–≤–∞—à_shop_id_–∑–¥–µ—Å—å"
YOOKASSA_SECRET_KEY="–≤–∞—à_secret_key_–∑–¥–µ—Å—å"

# Currency API (–¶–ë –†–§)
CBR_API_URL="https://www.cbr-xml-daily.ru/daily_json.js"

# Service Configuration
NODE_ENV="development"
HTTP_PORT=3006
HOST=0.0.0.0
JWT_SECRET="your-super-secret-jwt-key-here"
FRONTEND_URL="http://localhost:3000"
LOG_LEVEL="debug"
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–µ–π –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
docker-compose up payment-service

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs payment-service

# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:
# "Payment service started on port 3006"
```

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ÆKassa:** [yookassa.ru/docs](https://yookassa.ru/docs)
2. **–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞:** support@yookassa.ru
3. **API —Å—Ç–∞—Ç—É—Å:** [status.yookassa.ru](https://status.yookassa.ru)

---

**–í–∞–∂–Ω–æ:** –ë–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π –ÆKassa –ø–ª–∞—Ç–µ–∂–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ –±—É–¥—É—Ç!
